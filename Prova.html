<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>CALCOLO MOTIVICO</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.4.4/math.js"></script>
    <script src="https://cdn.rawgit.com/davidedc/Algebrite/master/dist/algebrite.bundle-for-browser.js"></script>
</head>
<body>
    <h1>DEFINITIVO</h1>
     <p> Al momento il programma fa la segunete cosa, dato un polinomio p nella variabile L e un numero n, sviluppa (1-t)^(p) a un ordine bastanza alto in modo che i primi n coefficienti siano corretti. A breve troncherò in modo che compaiano solo i termini corretti. So che è semplice e sappiamo farlo tutti, ma datemi tempo. Che poi si rivoluziona. Qesti sono solo due giorni di lavoro senza che abbia mai fatto niente in javascript</p>
     <p> GRAZIE Chatgpt </p>
    <label for="polinomioInput">Inserisci il polinomio (Es. 1 + 2L):</label>
    <input type="text" id="polinomioInput" placeholder="Es. 1 + 2L">
    <br><br> 
    <label for="gradoSviluppo">Grado di attendibilità:</label>
    <input type="number" id="gradoSviluppo" min="0" value="1">
    <br><br>
<button onclick="sviluppoCompleto(math.parse(document.getElementById('polinomioInput').value) )">Sviluppo completo</button>
    
    <div id="output"></div>

    <script>
        var output = document.getElementById('output');
	
	function sviluppoMonomio(p,n){
		var t = math.parse('t');
		var sviluppo = math.parse('0');
            for (var i = 0; i < n; i++) {
		sviluppo = sviluppo +'+'+ math.simplify(math.parse('(((' + p.toString() + ')*t)^'+i+')'));
            } 
		var espansione = Algebrite.expand( sviluppo.toString() );
		return espansione;
	}

	function sviluppoCompleto(p){

            output.innerHTML = ''; // Pulisce l'output precedente

	     var completo = 1;
	     var numero  = parseInt(math.simplify( (parseInt(document.getElementById('gradoSviluppo').value)).toString()+ '+1')); 
	     for (var i = 0; i < degreePolynomial(p,math.parse('0'))+1 ; i++) {
		completo =     Algebrite.expand( math.parse( '(' + completo.toString() + ')*(' + (Algebrite.expand( sviluppoMonomio(estraiTermine(p,i),numero))).toString()+ ')').toString()  );
            }
		output.innerHTML += "<p>"   + completo  +"</p>";	    
}
	        function estraiTermine(p, n) {
    var node = p;
    var grado = parseInt(n);
    var der = nthDerivative(node, grado).evaluate({ L: 0 }) / fattoriale(grado);
    var fattore = math.simplify(math.parse('((' + der + '))*L^' + grado.toString()));
    
    return fattore; // Restituisce il valore calcolato invece di manipolare l'output direttamente
}

        function nthDerivative(f, n) {
            var result = f;
            for (var i = 0; i < n; i++) {
                result = math.derivative(result, 'L');
            }
            return result;
        }
        function fattoriale(n) {
            if (n === 0 || n === 1) {
                return 1;
            } else {
                return math.multiply(n, fattoriale(n - 1));
            }
        }

	function degreePolynomiala(p,i){
	if (math.derivative(p, 'L').evaluate({ L: 0 }) == 0 ) {
                return i;
            } else {
            //output.innerHTML += "<p>"   + math.derivative(p, 'L') + "</p>";
                degreePolynomial(math.derivative(p, 'L'),i+1);
            }
	
}
	function degreePolynomial(p,i){
	    var j = parseInt(i); 
            if (math.derivative(p, 'L').evaluate({ L: 0 }) === 0  ) {
                return i;
            } else {
	       var q= math.derivative(p, 'L');
               return degreePolynomial( q , j+parseInt('1'));
            }
}

    </script>

</body>
</html>
